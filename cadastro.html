<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta name="theme-color" content="#e8b4b8">
    <meta charset="UTF-8">
    <title>Cadastro - Espa칞o Cura e Cuidado</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <section class="hero">
        <h2>Criar Nova Conta</h2>
        <form id="formCadastro" style="display: flex; flex-direction: column; max-width: 320px; margin: 0 auto; gap: 10px;">
            
            <input type="text" id="nome" placeholder="Nome Completo" required>
            
            <input type="text" id="usuario" placeholder="Nome de Usu치rio" oninput="this.value = this.value.toLowerCase()" required>
            
            <div style="display: flex; gap: 5px;">
                <input type="text" id="emailUser" placeholder="E-mail (ex: ana)" required style="flex: 1;">
                <select id="dominioEmail" style="border-radius: 5px; border: 1px solid #ddd; background: #fff;">
                    <option value="@gmail.com">@gmail.com</option>
                    <option value="@hotmail.com">@hotmail.com</option>
                    <option value="@outlook.com">@outlook.com</option>
                </select>
            </div>

            <input type="password" id="senha" placeholder="Senha de Acesso (m칤n. 6 d칤gitos)" required>
            <small id="senhaAviso" style="color: #888; font-size: 0.8rem; margin-top: -5px;">A senha deve ter pelo menos 6 caracteres.</small>
            
            <hr style="width: 100%; border: 0; border-top: 1px solid #eee; margin: 10px 0;">
            
            <input type="text" id="rua" placeholder="Rua ou Avenida">
            <input type="text" id="numero" placeholder="N춿 da casa">
            <input type="text" id="bairro" placeholder="Bairro">
            <input type="text" id="cidade" placeholder="Cidade">
            <input type="text" id="estado" placeholder="Estado">
            
            <input type="text" id="cep" maxlength="10" placeholder="CEP: 00.000-000" oninput="formatarCEP(this)" required>
            
            <button type="submit" style="background-color: #e8b4b8; color: white; border: none; padding: 10px; border-radius: 5px; cursor: pointer; font-weight: bold;">
                Finalizar Cadastro
            </button>
        </form>

        <p><a href="login.html">J치 tenho conta (Voltar ao login)</a></p>
        <div style="margin-top: 15px;">
            <p>Ou continue como <a href="index.html" onclick="entrarComoVisitante()" style="color: #e8b4b8; font-weight: bold;">Visitante</a></p>
        </div>
    </section>

    <script>
        // 1. M치scara para o CEP
        function formatarCEP(campo) {
            let v = campo.value.replace(/\D/g, ""); 
            v = v.replace(/^(\d{2})(\d)/, "$1.$2"); 
            v = v.replace(/(\d{3})(\d)/, "$1-$2");  
            campo.value = v;
        }

        function entrarComoVisitante() {
            localStorage.removeItem('usuarioLogado');
        }

        // 2. L칩gica de Envio e Valida칞칚o
        document.getElementById('formCadastro').addEventListener('submit', function(e) {
            e.preventDefault();

            const senha = document.getElementById('senha').value;

            // Valida칞칚o de Senha
            if (senha.length < 6) {
                alert("游 A senha precisa ter pelo menos 6 caracteres para sua seguran칞a.");
                document.getElementById('senha').style.borderColor = "red";
                document.getElementById('senha').focus();
                return; 
            }

            document.getElementById('senha').style.borderColor = "#ddd";
            const emailFinal = document.getElementById('emailUser').value.trim() + document.getElementById('dominioEmail').value;

            const dadosParaEnviar = {
                acao: "cadastro",
                nome: document.getElementById('nome').value,
                usuario: document.getElementById('usuario').value.toLowerCase().trim(),
                email: emailFinal,
                senha: senha,
                rua: document.getElementById('rua').value,
                numero: document.getElementById('numero').value,
                bairro: document.getElementById('bairro').value,
                cidade: document.getElementById('cidade').value,
                estado: document.getElementById('estado').value,
                cep: document.getElementById('cep').value
            };

            fetch('https://script.google.com/macros/s/AKfycbx35BCNL4rVOi8CxDtBS5AmHZbmUv9xutT6cz8qcL3ZeRWGB2TuXv60PF5nMLhuktG7/exec', {
                method: 'POST',
                mode: 'no-cors',
                body: JSON.stringify(dadosParaEnviar)
            })
            .then(() => {
                alert('Tudo pronto! Seu cadastro foi realizado com sucesso. 游꺚');
                window.location.href = 'login.html';
            })
            .catch(err => alert('Erro ao salvar: ' + err));
        });
    </script>
</body>
</html>
